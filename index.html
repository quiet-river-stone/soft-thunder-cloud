<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Modular Hearts Layout</title>

  <link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Password gate overlay -->
<div id="pw-overlay" role="dialog" aria-modal="true">
  <div id="pw-box">
    <h3>Enter password to view</h3>
    <div>Type the access password to continue.</div>
    <input id="pw-input" type="password" placeholder="Password" aria-label="Password" />
    <button id="pw-submit">Unlock</button>
    <div id="pw-error" aria-live="polite"></div>
  </div>
</div>

<canvas id="canvas"></canvas>
<div class="container" id="content"></div>

<script type="module" src="main.js"></script>

<script>
  (function(){
    const PASSWORD = 'valentine'; // inline fallback so file:// testing works
    const overlay = document.getElementById('pw-overlay');
    const input = document.getElementById('pw-input');
    const submit = document.getElementById('pw-submit');
    const errorEl = document.getElementById('pw-error');

    function unlock(){
      try{ overlay && overlay.parentNode.removeChild(overlay); }catch(e){}
      try{ sessionStorage.setItem('page_unlocked','1'); }catch(e){}
      try{ window.dispatchEvent(new CustomEvent('pageUnlocked')); }catch(e){}
    }

    function fail(msg){ if(errorEl) errorEl.textContent = msg || 'Incorrect password'; }

    if(submit && input){
      submit.addEventListener('click', ()=>{
        const v = (input.value||'').trim();
        if(v === PASSWORD) unlock(); else fail();
      });

      input.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') submit.click(); });
    }

    if(sessionStorage.getItem && sessionStorage.getItem('page_unlocked') === '1'){
      unlock();
      // continue
    }

    try{
      const qp = new URLSearchParams(location.search).get('pw');
      if(qp){ if(qp === PASSWORD) unlock(); else fail('Invalid URL password'); }
    }catch(e){}
  })();
  console.log('inline pw script initialized');
</script>
<!-- content and hearts moved to modules: content.js and hearts.js -->

</body>
</html>
